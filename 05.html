<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>HgInit: Arquitetura de repositório</title>

<script src="c/jquery-1.4.1.js"></script>
<script src="c/basic.js"></script>

<link href="i/Hg.ico" rel="shortcut icon" />

<link href="c/styles.css" rel="stylesheet" type="text/css" />
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-225715-20");
pageTracker._setDomainName("none");
pageTracker._setAllowLinker(true);
pageTracker._trackPageview();
} catch(err) {}</script>

	<!-- Google Website Optimizer Control Script -->
	<script>
	function utmx_section(){}function utmx(){}
	(function(){var k='2687020024',d=document,l=d.location,c=d.cookie;function f(n){
	if(c){var i=c.indexOf(n+'=');if(i>-1){var j=c.indexOf(';',i);return c.substring(i+n.
	length+1,j<0?c.length:j)}}}var x=f('__utmx'),xx=f('__utmxx'),h=l.hash;
	d.write('<sc'+'ript src="'+
	'http'+(l.protocol=='https:'?'s://ssl':'://www')+'.google-analytics.com'
	+'/siteopt.js?v=1&utmxkey='+k+'&utmx='+(x?x:'')+'&utmxx='+(xx?xx:'')+'&utmxtime='
	+new Date().valueOf()+(h?'&utmxhash='+escape(h.substr(1)):'')+
	'" type="text/javascript" charset="utf-8"></sc'+'ript>')})();
	</script><script>utmx("url",'A/B');</script>
	<!-- End of Google Website Optimizer Control Script -->
</head>
<body>
	<div id="kilnFlyOut">
		<div class="flyouttext">
		<strong>Kiln lhe oferece:</strong><br />

		&#8226; Controle de versão baseado no <a href="http://mercurial.selenic.com/" target="_blank" onClick="javascript: pageTracker._trackPageview('/outbound/flyout/mercurial.selenic.com');">Mercurial</a> e <a href="http://git-scm.com">Git</a><br />
	  &#8226; <a href="http://www.fogcreek.com/kiln/features/team-up/" target="_blank" onClick="javascript: pageTracker._trackPageview('/outbound/flyout/branchandmerge.kilnhg.com');">Ramificação e mesclagem</a> que realmente funciona
	  </div>
	  
	 <div class="flyouttext">
	  &#8226; Hospedagem segura em nossos servidores<br />
	  &#8226; <a href="http://www.fogcreek.com/kiln/features/code-reviews" target="_blank" onClick="javascript: pageTracker._trackPageview('/outbound/flyout/startreviews.kilnhg.com');">Revisão de código</a> perfeitamente integrada
	  </div>
	 <div class="flyouttext"> <a href="https://secure.fogcreek.com/kiln/try/?fccmp=hginit" target="_blank" onClick="javascript: pageTracker._trackPageview('/outbound/flyout/freetrial.shop.fogcreek.com');"><img src="i/getstarted.gif" width="182" height="24" border="0" /></a>
	 </div>
	 <div class="flyoutteaser"><nobr><strong>Experimente o Kiln!</strong> Hospedagem Mercurial e muito mais.</nobr></div>
	</div>

<div class="toptop" align="left">
    <ul>
        <li align="center" style="width:220px"><a href="http://about.me/mfandrade">Traduzido por Marcelo F Andrade</a></li>
        <li align="center"><a href="http://www.joelonsoftware.com/" onClick="javascript: pageTracker._trackPageview('/outbound/toptop/joelonsoftware.com');">Joel on Software</a></li>
        <li align="center"><a href="http://mercurial.selenic.com/" onClick="javascript: pageTracker._trackPageview('/outbound/toptop/mercurial.selenic.com');">Mercurial</a></li>
        <li align="center"><a href="index.html">Home</a></li>
    </ul>
</div>
<div id="dropshadow"></div>
<div id="topnav">
  <div class="tInterior">
      <a href="index.html">
        <img src="i/logo.png" border="0" alt="HgInit Home" />
      </a>
  
  O Mercurial lhe dá uma grande flexibilidade na criação de repositórios.
  Como as tarefas de merge funcionam bem, você pode depender delas, o que significa que você pode
  manter repositórios para propósitos específicos para se adequar a seu processo de desenvolvimento.

  </div>
</div>
<div class="main">
  <h1>Arquitetura de repositório</h1>
  <div class="content">
  
<p>Nossa receita está ficando muito boa:</p>

<div class="codesnippet">
<div class="codetop"> </div>
<pre>
C:\Users\joel\receitas&gt; <strong>hg log -l 3</strong>
changeset:   13:1b03ab783b17
tag:         tip
parent:      12:f923c9049234
parent:      11:0bd396c9b89b
user:        Rose Hillman &lt;rose@example.com&gt;
date:        Thu Feb 11 23:01:55 2010 -0500
summary:     merge

changeset:   12:f923c9049234
parent:      10:8646f8cd7154
user:        Rose Hillman &lt;rose@example.com&gt;
date:        Thu Feb 11 22:49:31 2010 -0500
summary:     mmmmanga

changeset:   11:0bd396c9b89b
user:        Joel Spolsky &lt;joel@joelonsoftware.com&gt;
date:        Thu Feb 11 22:46:47 2010 -0500
summary:     bananas HUMM
</pre>
<div class="codebottom"> </div>
</div>

<p>Vamos dar uma olhada melhor no número dos changesets:</p>

<div class="codesnippet">
<div class="codetop"> </div>
<pre>
changeset:   <strong>13</strong>:1b03ab783b17
</pre>
<div class="codebottom"> </div>
</div>

<p>A primeira parte do número, 13, é curta e conveniente.  Só tem um problema: não é confiável!</p>

<p>Quando as pessoas na sua equipe trabalham separadamente e mesclam suas alterações, estes números curtos ficam dessincronizados:</p>

<img src="i/05-repo.png" />


<p>Então, para todos os fins e propósitos, eu não posso dizer às pessoas &#8220;OK, vamos entregar a revisão baseada no changeset 13#8221;, porque eles podem ter diferentes ideias sobre que changeset 13.  E é por isso que há aquele número hexadecimal maluco.</p>

<div class="codesnippet">
<div class="codetop"> </div>
<pre>
changeset:   13:<strong>1b03ab783b17</strong>
</pre>
<div class="codebottom"> </div>
</div>

<p>O número hexadecimal é <em>consistente</em> por todos os repositórios e nunca vai mudar.</p>

<p>OK, então eu posso dizer às pessoas &#8220;Ei, vamos fazer uma entrega hoje!  Changeset número 1b03ab783b17!  Não seria legal se pudéssemos dar um <em>nome</em> a este changeset?</p>

<p>Bem, nós podemos.  E esse nome é chamado de <strong>tag</strong>.</p>

<div class="codesnippet">
<div class="codetop"> </div>
<pre>
C:\Users\joel\receitas&gt; <strong>hg tag Version-1.0</strong>
</pre>
<div class="codebottom"> </div>
</div>

<p>Vejamos o log agora:</p>

<div class="codesnippet">
<div class="codetop"> </div>
<pre>
C:\Users\joel\receitas&gt; <strong>hg log -l 2</strong>
changeset:   14:1adc88356f40
tag:         tip
user:        Joel Spolsky &lt;joel@joelonsoftware.com&gt;
date:        Fri Feb 12 09:38:06 2010 -0500
summary:     Added tag Version-1.0 for changeset 1b03ab783b17

changeset:   13:1b03ab783b17
tag:         Version-1.0
parent:      12:f923c9049234
parent:      11:0bd396c9b89b
user:        Rose Hillman &lt;rose@example.com&gt;
date:        Thu Feb 11 23:01:55 2010 -0500
summary:     merge
</pre>
<div class="codebottom"> </div>
</div>

<p>Perceba que o simples ato de adicionar a tag foi um changeset, e nele também foi dado um commit automaticamente.  A partir de agora, toda ver que eu quiser me referenciar ao código que estamos entregando, eu posso usar <strong>Version-1.0</strong> ao invés de <strong>1b03ab783b17</strong>.</p>

<p>O CEO veio do 31º andar até nosso salão de trabalho com uma caixa de um espumante importado que parecia bem cara.  O Stan ficou um pouco embrigado.  Na verdade, não só um pouco.  Ninguém já tinha visto nada como aquilo.  Ele tirou sua camisa, mostrando seus músculos e flácidos tentando impressionar as meninas do departamento de marketing.  &#8220;Eu consigo fazer flexões de barra na luminária&#8221;, ele bradava (nós temos aquelas luminárias suspensas com lâmpadas fluorescentes).  Então ele pulou, se agarrou na peça e, é claro, trouxe tudo aquilo abaixo na mesma hora, afinal a luminária era uma estrutura fixa suspensa no teto apenas por uns fios de sustentação, que certamente não suportam os cento e tantos quilos do Stan.  Tudo veio abaixo, inclusive parte do telhado.  Vidro quebrado, metal e entulho para tudo quanto era lado.  Depois de cair de bunda no chão, Stan ainda ficou resmungando e dizendo que ia acionar a empresa por nos deixar num ambiente de trabalho tão inseguro.</p>

<p>Eu e os demais da equipe voltamos aos nossos computadores para trabalhar no Guac 2.0.</p>

<div class="edit1">
                <div class="edittopbefore">
                guac </div>
                <div class="editcontent">
* 2 abacates maduros do tipo Hass (não Haas)<br />
* 1/2 cebola roxa picada, (cerca de 1/2 xícara)<br />
* 1-2 pimentas jalapeño chiles, sem talo e sem sementes, picadas<br />
* 2 colheres de sopa de coentro, picado bem fininho<br />
* 1 colher de sopa de suco de limão<br />
* 1/2 colher de chá de sal grosso<br />
* Uma pitada de pimenta-do-reino moída na hora<br />
* 1/2 tomate maduro, sem pele e sem sementes, picado<br />
* 1 MANGA grande e madura, da estação.<br />
* 1 deliciosa BANANA amarela.<br />
                </div>
                <img src="i/edit-bot.gif" width="387" height="76" />
    </div>


<div class="edit2">
	<img src="i/arrow2.gif" width="83" height="97" class="editArrow" />
	<div class="edittopafter">    
		guac
	</div>
  <div class="editcontent">
<strong>GUACAMOLE 2.0 VAI FICAR SENSACIONAL!</strong><br /><br />

* 2<strong>00</strong> abacates maduros do tipo Hass (não Haas)<br />
* 1/2 cebola roxa picada, (cerca de 1/2 xícara)<br />
* 1-2 pimentas jalapeño chiles, sem talo e sem sementes, picadas<br />
* 2 colheres de sopa de coentro, picado bem fininho<br />
* 1 colher de sopa de suco de limão<br />
* 1/2 colher de chá de sal grosso<br />
* Uma pitada de pimenta-do-reino moída na hora<br />
* 1/2 tomate maduro, sem pele e sem sementes, picado<br />
* 1 MANGA grande e madura, da estação.<br />
* 1 deliciosa BANANA amarela.<br />
   </div>
  <img src="i/edit-bot.gif" width="387" height="76" />
 </div>
 
 <div style="clear: both;">&nbsp;</div>

<p>Commit:</p>

<div class="codesnippet">
<div class="codetop"> </div>
<pre>
C:\Users\joel\receitas&gt; <strong>hg com -m "agora com mais abacate"</strong>
</pre>
<div class="codebottom"> </div>
</div>

<p>Nem precisa dizer que a receita agora está num estado bem instável.  Ela não foi testada nem nada.  E eis que o (único) cliente demanda.</p>

<p>&#8220;A guacamole está muito salgada!&#8221; ele reclama.  E não, ele não pode esperar até a versão 2.0 ficar pronta por uma correção.</p>

<p>Por sorte, nós tínhamos aquela tag.  Eu posso usar <strong>hg up</strong> para voltar para qualquer versão no repositório.</p>

<div class="codesnippet">
<div class="codetop"> </div>
<pre>
C:\Users\joel\receitas&gt; <strong>hg up -r Version-1.0</strong>
1 files updated, 0 files merged, 1 files removed, 0 files unresolved

C:\Users\joel\receitas&gt; <strong>type guac</strong>
* 2 abacates maduros do tipo Hass (não Haas)
* 1/2 cebola roxa picada (cerca de 1/2 xícara)
* 1-2 pimentas jalapeño, sem talo e sem sementes, picadas
...
</pre>
<div class="codebottom"> </div>
</div>

<p>E agora eu posso corrigir esse problema bobo de excesso de sal:</p>

<div class="edit1">
                <div class="edittopbefore">
                guac </div>
                <div class="editcontent">
* 2 abacates maduros do tipo Hass (não Haas)<br />
* 1/2 cebola roxa picada (cerca de 1/2 xícara)<br />
* 1-2 pimentas jalapeño, sem talo e sem sementes, picadas<br />
* 2 colheres de sopa de coentro picado bem fininho<br />
* 1 colher de sopa de suco de limão<br />
* 1/2 colher de chá de sal grosso<br />
* Uma pitada de pimenta-do-reino moída na hora<br />
* 1/2 tomate maduro, sem pele e sem sementes, picado<br />
* 1 MANGA grande e madura, da estação.<br />
* 1 deliciosa BANANA amarela<br />
                </div>
                <img src="i/edit-bot.gif" width="387" height="76" />
    </div>


<div class="edit2">
	<img src="i/arrow2.gif" width="83" height="97" class="editArrow" />
	<div class="edittopafter">    
		guac
	</div>
    <div class="editcontent">
* 2 abacates maduros do tipo Hass (não Haas)<br />
* 1/2 cebola roxa picada (cerca de 1/2 xícara)<br />
* 1-2 pimentas jalapeño, sem talo e sem sementes, picadas<br />
* 2 colheres de sopa de coentro picado bem fininho<br />
* 1 colher de sopa de suco de limão<br />
* <strong>1 grão de </strong>sal<strong> de cozinha, dividido ao meio</strong><br />
* Uma pitada de pimenta-do-reino moída na hora<br />
* 1/2 tomate maduro, sem pele e sem sementes, picado<br />
* 1 MANGA grande e madura, da estação.<br />
* 1 deliciosa BANANA amarela<br />
   </div>
  <img src="i/edit-bot.gif" width="387" height="76" />
 </div>
 
 <div style="clear: both;">&nbsp;</div>


<p>E:</p>

<div class="codesnippet">
<div class="codetop"> </div>
<pre>
C:\Users\joel\receitas&gt; <strong>hg diff</strong>
diff -r 1b03ab783b17 guac
--- a/guac      Thu Feb 11 23:01:55 2010 -0500
+++ b/guac      Fri Feb 12 10:44:19 2010 -0500
@@ -3,7 +3,7 @@
 * 1-2 pimentas jalapeño, sem talo e sem sementes, picadas
 * 2 colheres de sopa de coentro picado bem fininho
 * 1 colher de sopa de suco de limão
-* 1/2 colher de chá de sal grosso
+* 1 grão de sal de cozinha, dividido ao meio
 * Uma pitada de pimenta-do-reino moída na hora
 * 1/2 tomate maduro, sem pele e sem sementes, picado
 * 1 MANGA grande e madura, da estação.

C:\Users\joel\receitas&gt; <strong>hg com -m &quot;menos sal&quot;</strong>
created new head
</pre>
<div class="codebottom"> </div>
</div>

<p>O Mercurial me lembra que eu acabei de criar uma nova cabeça.  Existem duas cabeças agora: a cabeça da versão 2.0 na qual eu estava trabalhando e a cabeça desta 1.1 na qual acabei de dar commit.</p>


<img src="i/05-repo-2.png" />


<p>Agora eu posso fazer a entrega para meu cliente, marcá-la com uma tag 1.1, e voltar a trabalhar na versão 2.0.</p>

<div class="codesnippet">
<div class="codetop"> </div>
<pre>
C:\Users\joel\receitas&gt; <strong>hg tag -r . Version-1.1</strong>

C:\Users\joel\receitas&gt; <strong>hg log -l 3</strong>
changeset:   17:f4220e321145
tag:         tip
user:        Joel Spolsky &lt;joel@joelonsoftware.com&gt;
date:        Fri Feb 12 11:17:02 2010 -0500
summary:     Added tag Version-1.1 for changeset 60ddc0122eb4

changeset:   16:60ddc0122eb4
tag:         Version-1.1
parent:      13:1b03ab783b17
user:        Joel Spolsky &lt;joel@joelonsoftware.com&gt;
date:        Fri Feb 12 10:44:32 2010 -0500
summary:     menos sal

changeset:   15:90c349eca2e8
user:        Joel Spolsky &lt;joel@joelonsoftware.com&gt;
date:        Fri Feb 12 10:31:24 2010 -0500
summary:     agora com mais abacate


C:\Users\joel\receitas&gt; <strong>hg up -r 15</strong>
2 files updated, 0 files merged, 0 files removed, 0 files unresolved

C:\Users\joel\receitas&gt; <strong>type guac</strong>
GUACAMOLE 2.0 VAI FICAR SENSACIONAL!

* 200 abacates maduros do tipo Hass (não Haas)
* 1/2 cebola roxa picada (cerca de 1/2 xícara)
* 1-2 pimentas jalapeño, sem talo e sem sementes, picadas
* 2 colheres de sopa de coentro picado bem fininho
* 1 colher de sopa de suco de limão
* 1/2 colher de chá de sal grosso
* Uma pitada de pimenta-do-reino moída na hora
* 1/2 tomate maduro, sem pele e sem sementes, picado
* 1 MANGA grande e madura, da estação.
* 1 deliciosa BANANA amarela
...
</pre>
<div class="codebottom"> </div>
</div>

<p>O único problema é que a correção do sal não está mais aqui.  Como eu resolvo isso?</p>

<div class="codesnippet">
<div class="codetop"> </div>
<pre>
C:\Users\joel\receitas&gt; <strong>hg merge</strong>
merging .hgtags
</pre>
<div class="codebottom"> </div>
</div>



<img src="i/05-kdiff3.png" />


<p>Uh-oh!  Eu tenho que fazer um merge e combinar as tags.  Isto é um bug chato do Mercurial.  O problema é que as tags no Mercurial são apenas um arquivo chamado de .hgtags, e que também fica está sob controle de versão.  Então, ocasionalmente, você vai precisar ter de combinar o conteúdo de diferentes versões do arquivo .hgtags.  Em todo caso, tudo o que você tem a fazer é bem fácil&#8230; sempre mantenha AMBAS as versões de cada linha no arquivo.</p>

<div class="codesnippet">
<div class="codetop"> </div>
<pre>
merging guac
0 files updated, 2 files merged, 0 files removed, 0 files unresolved
(branch merge, don't forget to commit)

C:\Users\joel\receitas&gt; <strong>hg diff guac</strong>
diff -r 90c349eca2e8 guac
--- a/guac      Fri Feb 12 10:31:24 2010 -0500
+++ b/guac      Fri Feb 12 11:32:43 2010 -0500
@@ -5,7 +5,7 @@
 * 1-2 pimentas jalapeño, sem talo e sem sementes, picadas
 * 2 colheres de sopa de coentro picado bem fininho
 * 1 colher de sopa de suco de limão
-* 1/2 colher de chá de sal grosso
+* 1 grão de sal de cozinha, dividido ao meio
 * Uma pitada de pimenta-do-reino moída na hora
 * 1/2 tomate maduro, sem pele e sem sementes, picado
 * 1 MANGA grande e madura, da estação.

C:\Users\joel\receitas&gt; <strong>hg com -m "trazendo a correção de sal da versão 1.1"</strong>
</pre>
<div class="codebottom"> </div>
</div>

<p>Este método simples de voltar a versões anteriores com rótulo é ótimo para quando você só quer fazer uma pequena e inesperada correção no código de produção.  Mas a verdade é que na maioria dos projetos de software, este tipo de coisa acontece o tempo todo, e o Mercurial tem uma forma mais robusta de lidar com isso.</p>

<p>Então agora eu vou só desfazer todo o trabalho depois da versão 1.0 e ter meu repositório de volta à como ele estava quando eu tinha acabado de entregar a versão 1.0 da receita; e então vou poder mostrar o jeito mais robusto de corrigir bugs para o cliente enquanto se trabalha numa versão futura ao mesmo.</p>

<div class="codesnippet">
<div class="codetop"> </div>
<pre>
C:\Users\joel\receitas&gt; <strong>cd ..</strong>

C:\Users\joel&gt; <strong>hg clone -r 14 receitas receitas-estavel</strong>
requesting all changes
adding changesets
adding manifests
adding file changes
added 15 changesets with 15 changes to 2 files
updating to branch default
2 files updated, 0 files merged, 0 files removed, 0 files unresolved

C:\Users\joel&gt; <strong>cd receitas-estavel</strong>

C:\Users\joel\receitas-stable&gt; <strong>hg log -l 3</strong>
changeset:   14:1adc88356f40
tag:         tip
user:        Joel Spolsky &lt;joel@joelonsoftware.com&gt;
date:        Fri Feb 12 09:38:06 2010 -0500
summary:     Added tag Version-1.0 for changeset 1b03ab783b17

changeset:   13:1b03ab783b17
tag:         Version-1.0
parent:      12:f923c9049234
parent:      11:0bd396c9b89b
user:        Rose Hillman &lt;rose@example.com&gt;
date:        Thu Feb 11 23:01:55 2010 -0500
summary:     merge

changeset:   12:f923c9049234
parent:      10:8646f8cd7154
user:        Rose Hillman &lt;rose@example.com&gt;
date:        Thu Feb 11 22:49:31 2010 -0500
summary:     mmmmanga
</pre>
<div class="codebottom"> </div>
</div>

<p>A ideia é que ao invpes de fazer tudo em apenas um repositório, nós vamos trabalhar em dois repositórios, sendo um chamado de <strong>estável</strong> e outro chamado de <strong>dev</strong>.</p>

<p>O repositório <strong>estável</strong> contém a última versão principal do código que foi entregue para os clientes.  Sempre que você precisar corrigir um bug urgente, você o faz no <strong>estável</strong>.  Neste exemplo, vamos colocar todas as correções no 1.0.</p>

<p>O repositório <strong>dev</strong> é onde as codificações principais de desenvolvimento em si acontecem, e que vão nos levar à versão 2.0.</p>

<p>Tão logo a versão 1.0 seja entregue, eu vou clonar o repositório <strong>estável</strong> para <strong>dev</strong>:</p>

<div class="codesnippet">
<div class="codetop"> </div>
<pre>
C:\Users\joel\receitas-stable&gt; <strong>cd ..</strong>

C:\Users\joel&gt; <strong>hg clone receitas-estavel receitas-dev</strong>
updating to branch default
2 files updated, 0 files merged, 0 files removed, 0 files unresolved
</pre>
<div class="codebottom"> </div>
</div>

<p>Agora eu tenho dois repositórios idênticos:</p>


<img src="i/05-repo-3.png" />


<p>Como o histórico destes dois repositórios é o mesmo até o changeset 14, como vimos, o Mercurial vai utilizar um recurso de sistema de arquivos chamado de hard links para evitar de manter duas cópias em disco.  Isto faz com que a operação <strong>hg clone</strong> seja fácil e rápida.  Então nunca hesite em fazer vários e vários clones.</p>

<p>Agora podemos começar a trabalhar na receita de guacamole no repositório <strong>dev</strong>:</p>

<div class="codesnippet">
<div class="codetop"> </div>
<pre>
C:\Users\joel&gt; <strong>cd receitas-dev</strong>

C:\Users\joel\receitas-dev&gt; <strong>edit guac</strong>

C:\Users\joel\receitas-dev&gt; <strong>hg diff</strong>
diff -r 1adc88356f40 guac
--- a/guac      Fri Feb 12 09:38:06 2010 -0500
+++ b/guac      Fri Feb 12 15:15:01 2010 -0500
@@ -1,4 +1,6 @@
-* 2 abacates maduros do tipo Hass (não Haas)
+GUACAMOLE 2.0 VAI FICAR SENSACIONAL!
+
+* 200 abacates maduros do tipo Hass (não Haas)
 * 1/2 cebola roxa picada (cerca de 1/2 xícara)
 * 1-2 pimentas jalapeño, sem talo e sem sementes, picadas
 * 2 colheres de sopa de coentro picado bem fininho

C:\Users\joel\receitas-dev&gt; <strong>hg commit -m &quot;agora com mais abacate&quot;</strong>
</pre>
<div class="codebottom"> </div>
</div>

<p>E corrigir o problema do sal no repositório estável:</p>

<div class="codesnippet">
<div class="codetop"> </div>
<pre>
C:\Users\joel\receitas-dev&gt; <strong>cd ..\receitas-stable</strong>

C:\Users\joel\receitas-stable&gt; <strong>edit guac</strong>

C:\Users\joel\receitas-stable&gt; <strong>hg diff</strong>
diff -r 1adc88356f40 guac
--- a/guac      Fri Feb 12 09:38:06 2010 -0500
+++ b/guac      Fri Feb 12 15:18:31 2010 -0500
@@ -3,7 +3,7 @@
 * 1-2 pimentas jalapeño, sem talo e sem sementes, picadas
 * 2 colheres de sopa de coentro picado bem fininho
 * 1 colher de sopa de suco de limão
-* 1/2 colher de chá de sal grosso
+* 1 grão de sal de cozinha, dividido ao meio
 * Uma pitada de pimenta-do-reino moída na hora
 * 1/2 tomate maduro, sem pele e sem sementes, picado
 * 1 MANGA grande e madura, da estação.

C:\Users\joel\receitas-stable&gt; <strong>hg com -m "menos sal"</strong>
</pre>
<div class="codebottom"> </div>
</div>

<p>Vou marcar com uma tag e entregá-lo como versão 1.1:</p>

<div class="codesnippet">
<div class="codetop"> </div>
<pre>
C:\Users\joel\receitas-stable&gt; <strong>hg tag Version-1.1</strong>
</pre>
<div class="codebottom"> </div>
</div>

<p>E agora, vamos baixar as correções feitas no estável também para o dev:</p>

<div class="codesnippet">
<div class="codetop"> </div>
<pre>
C:\Users\joel\receitas-stable&gt; <strong>cd ..\receitas-dev</strong>

C:\Users\joel\receitas-dev&gt; <strong>hg in</strong>
comparing with c:\Users\joel\receitas-stable
searching for changes
changeset:   15:e05c954f961f
tag:         Version-1.1
user:        Joel Spolsky &lt;joel@joelonsoftware.com&gt;
date:        Fri Feb 12 15:28:27 2010 -0500
summary:     menos sal

changeset:   16:f0e8768829ed
tag:         tip
user:        Joel Spolsky &lt;joel@joelonsoftware.com&gt;
date:        Fri Feb 12 15:28:40 2010 -0500
summary:     Added tag Version-1.1 for changeset e05c954f961f


C:\Users\joel\receitas-dev&gt; <strong>hg pull</strong>
pulling from c:\Users\joel\receitas-stable
searching for changes
adding changesets
adding manifests
adding file changes
added 2 changesets with 2 changes to 2 files (+1 heads)
(run 'hg heads' to see heads, 'hg merge' to merge)

C:\Users\joel\receitas-dev&gt; <strong>hg merge</strong>
merging guac
0 files updated, 1 files merged, 0 files removed, 0 files unresolved
(branch merge, don't forget to commit)

C:\Users\joel\receitas-dev&gt; <strong>hg com -m &quot;merge&quot;</strong>

C:\Users\joel\receitas-dev&gt; <strong>type guac</strong>
GUACAMOLE 2.0 VAI FICAR SENSACIONAL!

* 200 abacates maduro do tipo Hass (não Haas)
* 1/2 cebola roxa picada (cerca de 1/2 xícara)
* 1-2 pimentas jalapeño, sem talo e sem sementes, picadas
* 2 colheres de sopa de coentro picado bem fininho
* 1 colher de sopa de suco de limão
* 1 grão de sal de cozinha, dividido ao meio
* Uma pitada de pimenta-do-reino moída na hora
* 1/2 tomate maduro, sem pele e sem sementes, picado
* 1 MANGA grande e madura, da estação.
* 1 deliciosa BANANA amarela

Amasse todos os ingredientes juntos.
Sirva com salgadinhos tipo nachos.
</pre>
<div class="codebottom"> </div>
</div>


<p>Para ver melhor o que estamos fazendo:</p>


<img src="i/05-repo-4.png" />


<p>Se você consegue entender <em>esse</em> gráfico maluco, então você está indo muito bem no seu entendimento do Mercurial.  O resumo disto tudo é que em algum momento talvez o repostório estável vai conter apenas correções de bugs enquanto que o desenvolvimento vai ter novos códigos e as correções de bugs do estável incorporadas em si.</p>

<p>Há ainda outras formas que você pode querer usar repositórios múltiplos.</p>

<ul>
  <li>Você pode configurar um repositório para a equipe onde só umas poucas pessoas trabalham juntas numa dada funcionalidade.  Quando elas tiverem terminado e a funcionalidade desenvolvida esteja funcionando bem, você transfere as alterações do repositório da equipe para o repositório principal do desenvolvimento, e então todos os demais podem vê-las.</li>
  <li>Você pode configurar um repositório de QA para os testadores.  Ao invés de transferir todas as atualizações para o repositório principal, você as manda para o repositório de QA onde seu código é testado.  Uma vez que os testadores o aprovem, você transfere o código do repositório de QA para o repositório principal de desenvolvimento.  Desta forma, o repositório principal sempre conterá código testado.</li>
  <li>Como cada desenvolvedor teu seu próprio repositório, você pode baixar um changeset experimental de algum colega para testá-lo, sem precisar disseminar tal alteração para todo o restante da equipe.</li>
</ul>

<p>Em organizações muito grandes e complexas, você pode combinar estas técnicoas, configurando uma porção de repositórios que baixem atualizações uns dos outros.  Conforme cada funcionalidade vai passando por etapas de teste e integração, ela é baixada e transferida ao longo da árvore de conexões de repositórios até que uma hora o novo código chegue ao repositório principal donde os cliente podem obtê-lo:</p>


 <img src="i/05-complex.png" />


<h2>Experimente você mesmo</h2>

<p>Eis aqui as coisas que você deve saber depois da leitura deste tutorial:</p>

<ol>
  <li>Marcar versões antigas com tags e retornar a elas</li>
  <li>Organizar sua equipe com repositórios &#8220;estável&#8221; e &#8220;dev&#8221;</li>
</li>
</ol>

<p>É isso!  Assim chegamos ao fim deste tutorial.  Eu não sequer cheguei <em>perto</em> de cobrir todos os recursos do Mercurial, mas há várias outras fontes de informação nas quais se aprofundar.
Aqui tem <a href="http://hgbook.red-bean.com/">um livro</a> que cobre completamente e em detalhes tudo desta ferramenta.
</p>

<div class="footer">
 <div class="footernav" id="home" align="center"><a href="index.html"><span class="angleQuote">&#171;</span> Home</a></div>
 
 <div class="footernav" id="comingup" style=" text-align: left; margin-left: 35px;">Para aprender mais, <a href="http://hgbook.red-bean.com/">leia o livro</a>!</div>


 
 
 </div>    

<div class="pagebottom">

        <div class="bottomimg">
		<a href="http://www.kilnhg.com" target="_blank" id="logoLink" title="KilnHg.com" onClick="javascript: pageTracker._trackPageview('/outbound/bottom/klinhg.com');">&nbsp;</a>
		<div class="bottomtext">This tutorial was brought to you by the fine folks at Fog Creek Software, makers of Kiln, a version control system powered by Mercurial</div>
        
        <div class="bottomtext"><strong>Kiln lhe oferece:</strong><br />

&#8226; Um sistema de controle de versão completo baseado no <a href="http://mercurial.selenic.com/" target="_blank" onClick="javascript: pageTracker._trackPageview('/outbound/bottom/mercurial.selenic.com');">Mercurial</a> e <a href="http://git-scm.com">Git</a><br />
&#8226; <a href="http://www.fogcreek.com/kiln/features/team-up" target="_blank" onClick="javascript: pageTracker._trackPageview('/outbound/bottom/branchandmerge.kilnhg.com');">Ramificação e mesclagem</a> que realmente funcionam<br />
&#8226; Hospedagem segura em nossos servidores<br />
&#8226; <a href="http://www.fogcreek.com/kiln/features/code-reviews" target="_blank" onClick="javascript: pageTracker._trackPageview('/outbound/bottom/startreviews.kilnhg.com');">Revisão de código</a> perfeitamente integrada<br />
</div>
      
      <div class="bottomtext getStarted">
      <a href="https://secure.fogcreek.com/kiln/try/?fccmp=hginit" target="_blank" onClick="javascript: pageTracker._trackPageview('/outbound/bottom/freetrial.shop.fogcreek.com');"><img src="i/getstarted.gif" width="182" height="24" border="0" /></a>
      </div>  
        
      </div>             
        <div class="about">
          <p>
            <strong>Quer mais?</strong>
          </p>
          
          <p>
            A Fog Creek oferece webinários mensais gratuitos que abordam além dos conceitos básicos do Mercurial.
            Cadastre-se em <a href="http://www.fogcreek.com/kiln/training/#training">fogcreek.com</a>.
          </p>

          <p>
            <strong>Perguntas?</strong>
          </p>
          
          <p>
            Procurando ajuda com o <a href="http://fogcreek.com/kiln">Kiln</a>?  Confira a <a href="http://help.fogcreek.com/kiln">Base de Conhecimentos do Kiln</a>.
          </p>

          <p>
            <strong>Sobre o autor.</strong>
          </p> 
        
          <p>
Joel Spolsky é o fundador da <a href="http://fogcreek.com" onClick="javascript: pageTracker._trackPageview('/outbound/bottom/fogcreek.com');">Fog Creek Software</a>, uma empresa de Nova York que prova que você pode tratar bem seus programadores e ainda assim ser lucrativo.  Os programadores têm escritórios particulares, almoço gratuito e trabalham não mais que 40 horas por semana.  Os clientes só pagam pelo software se eles gostarem do resultado.  A Fog Creek é a criadora do <a href="http://www.fogbugz.com" onClick="javascript: pageTracker._trackPageview('/outbound/bottom/fogbugz.com');">FogBugz</a>, do <a href="http://www.kilnhg.com/" onClick="javascript: pageTracker._trackPageview('/outbound/bottom/text.kilnhg.com');">Kiln</a> e do <a href="https://www.copilot.com/" onClick="javascript: pageTracker._trackPageview('/outbound/bottom/copilot.com');">Fog Creek Copilot</a>.  O blog do Joel, <a href="http://www.joelonsoftware.com/" onClick="javascript: pageTracker._trackPageview('/outbound/bottom/joelonsoftware.com');">Joel on Software</a>, é uma referência para programadores no mundo todo.
            
           </p>
        
        </div>


<!-- close bottom div -->
</div>
    
    
<!-- close "content" column -->     
</div>

<!-- close "main" div -->
</div>

<!-- bottom grey bar -->
<div class="botbot" align="left">
</div>

<!-- Google Website Optimizer Tracking Script -->
<script type="text/javascript">
if(typeof(_gat)!='object')document.write('<sc'+'ript src="http'+
(document.location.protocol=='https:'?'s://ssl':'://www')+
'.google-analytics.com/ga.js"></sc'+'ript>')</script>
<script type="text/javascript">
try {
var gwoTracker=_gat._getTracker("UA-225715-15");
gwoTracker._trackPageview("/2687020024/test");
}catch(err){}</script>
<!-- End of Google Website Optimizer Tracking Script -->

</body>

</html>
